

---

# CV_lab_3_Bodya

Цей репозиторій містить лабораторну роботу з комп’ютерного зору, що демонструє використання методів зменшення розмірності (PCA, TSNE), кластеризації (KMeans), побудови та навчання автоенкодера, а також аугментації даних (RandomOverSampler, SMOTE, ADASYN). Крім того, реалізовано порівняння продуктивності обчислень на CPU та GPU із візуалізацією результатів за допомогою Dash.
![image](https://github.com/user-attachments/assets/32eede0c-df48-4de6-bb73-73fe294c44b3)
![image](https://github.com/user-attachments/assets/b85d91c5-d4ca-4af2-bd65-6437479c21f6)
![image](https://github.com/user-attachments/assets/a029b219-60c2-442c-ba38-4c5c807439b6)

---

## Вимоги

- **Python:** 3.10
- **TensorFlow:** встановлюйте відповідну версію залежно від апаратного забезпечення (tensorflow-cpu, tensorflow-gpu, tensorflow-directml тощо)
- **scikit-learn**
- **imbalanced-learn**
- **Dash та Plotly**
- **numpy, matplotlib**

---

## Інструкція з встановлення

1. **Клонування репозиторію:**

   ```bash
   git clone https://github.com/xaxinotf/CV_lab_3_Bodya.git
   ```

2. **Створення віртуального середовища:**

   ```bash
   python -m venv .venv
   ```

3. **Активація віртуального середовища:**

   - **Windows:**
     ```bash
     .venv\Scripts\activate
     ```
   - **Linux/macOS:**
     ```bash
     source .venv/bin/activate
     ```

4. **Встановлення залежностей:**

   Якщо у вас є файл `requirements.txt`, запустіть:
   ```bash
   pip install -r requirements.txt
   ```
   Якщо файлу немає, встановіть вручну:
   ```bash
   pip install tensorflow scikit-learn imbalanced-learn dash plotly numpy matplotlib
   ```

---

## Опис файлів

- **0_mocap_optimazed.py**  
  Основний скрипт, який:
  - Завантажує дані з `shaped.pickle`
  - Здійснює редукцію розмірності (TruncatedSVD та TSNE)
  - Виконує кластеризацію (KMeans)
  - Будує та навчає автоенкодер (shallow neural network)
  - Проводить оцінку класифікатора з використанням аугментації даних (RandomOverSampler, SMOTE, ADASYN)
  - Виводить результати та метрики часу виконання.

- **CPU_old.py**  
  Скрипт для запуску повного пайплайна **лише на CPU**.  
  GPU відключається за допомогою змінної оточення `CUDA_VISIBLE_DEVICES="-1"`.

- **GPU_old.py**  
  Скрипт для запуску повного пайплайна з використанням **GPU** (якщо він доступний).

- **dash_gpu_cpu.py**  
  Інтерактивний Dash-додаток для порівняння результатів роботи пайплайна на CPU та GPU.  
  Додаток включає:
  - Технічні характеристики CPU та GPU (без деталей моделі, лише основні дані)
  - Графіки метрик часу (SVD, TSNE, KMeans, навчання автоенкодера, час роботи класифікації)
  - Графіки точності класифікатора
  - TSNE-кластеризацію
  - Таблиці з чисельними значеннями показників
  - Додатковий звіт із зазначенням версії ОС, версії TensorFlow, виробників CPU/GPU та середнього часу ітерації навчання автоенкодера.

- **mocap_tsne_autoencoder_directml2 (3).ipynb**  
  Jupyter Notebook, що містить інтерактивний код з використанням TSNE, автоенкодера та кластеризації даних.  
  Використовується для експериментальної валідації підходів.

- **mocap_tsne_autoencoder_directml2 (3).py**  
  Пітон-скрипт, який містить аналогічний код до Notebook для запуску поза середовищем Jupyter.

- **shaped.pickle**  
  Файл з обробленими даними, який використовується для навчання моделей та проведення експериментів.

---

## Як запустити

- **Основний пайплайн:**  
  ```bash
  python 0_mocap_optimazed.py
  ```

- **Запуск на CPU:**  
  ```bash
  python CPU_old.py
  ```

- **Запуск на GPU:**  
  ```bash
  python GPU_old.py
  ```

- **Dash-додаток (порівняння CPU vs GPU):**  
  ```bash
  python dash_gpu_cpu.py
  ```

---

## Додатковий звіт

У звіті відображаються наступні дані:

- **Версія операційної системи:**  
  Наприклад, Windows 10, Ubuntu 20.04 або MacOS.

- **Версія TensorFlow:**  
  (наприклад, tensorflow-cpu, tensorflow-gpu, tensorflow-directml тощо).

- **Виробник CPU та GPU:**  
  - **CPU:** Наприклад, AMD (без деталей моделі).
  - **GPU:** Наприклад, NVIDIA (без деталей моделі, пам’яті тощо).

- **Час виконання (середній час ітерації навчання автоенкодера):**  
  Розраховується як загальний час навчання, поділений на кількість епох (припускається, що з другої епохи час є більш стабільним).

---

## Приклад технічних характеристик (для Dash-візуалізації)

**CPU:**  
- AMD Ryzen 5 5600 6-Core Processor  
- Базова швидкість: 3,50 ГГц  
- Сокетів: 1  
- Ядра: 6  
- Логічних процесорів: 12  
- Віртуалізація: Включено  
- Кеш L1: 384 КБ  
- Кеш L2: 3,0 МБ  
- Кеш L3: 32,0 МБ  
- Використання: 2%  
- Швидкість: 3,77 ГГц  
- Час роботи: 2:23:50:13  
- Процеси: 209  
- Потоки: 3624  
- Дескриптори: 100352  

**GPU:**  
- NVIDIA GeForce RTX 3070 palit  
- Версія драйвера: 32.0.15.6094  
- Дата розробки: 14.08.2024  
- Версія DirectX: 12 (FL 12.1)  
- Фізичне розташування: PCI-шина 38, пристрій 0, функція 0  
- Використання: 4%  
- Виділена пам'ять: 0,7/8,0 ГБ  
- Загальна пам'ять: 0,1/16,0 ГБ  
- Оперативна пам'ять: 0,7/24,0 ГБ  

---

